#pragma once

#define X32_CTRL_VERSION "v0.2.5"
#define BUILD_DEBUG 1 // build with or without debug functions
#define X32_CTRL_URL "https://github.com/OpenMixerProject/OpenX32"
#define X32_CTRL_CONFIGFILE "x32ctrl.cfg"
#define X32_MIXER_CONFIGFILE "mixer.ini"

#define TIMER_1MS 1000000 // 1ms = 1000000ns
#define TIMER_100MS 100 * TIMER_1MS 
#define TIMER_50MS   50 * TIMER_1MS
#define TIMER_10MS   10 * TIMER_1MS

#define SPI_DEVICE_DSP1 "/dev/spidev0.0"
#define SPI_DEVICE_DSP2 "/dev/spidev0.1"
#define SPI_DEVICE_FPGA "/dev/spidev2.0"
#define MHz * 1000000
#define SPI_FPGA_SPEED_HZ       8 MHz
#define SPI_DSP_CONF_SPEED_HZ   8 MHz
#define SPI_DSP_SPEED_HZ        8 MHz // 16 MHz is the regular SPI-clock on the original X32

#define PI 3.14159265358979323846f
#define MAX_NAME_LENGTH 30 + 1 // null termination!
#define SURFACE_MAX_PACKET_LENGTH 32

#define DISPLAY_RESOLUTION_X 800
#define DISPLAY_RESOLUTION_Y 480

#define MAX_DISPLAY_ENCODER 6
#define DISPLAY_ENCODER_1   0
#define DISPLAY_ENCODER_2   1
#define DISPLAY_ENCODER_3   2
#define DISPLAY_ENCODER_4   3
#define DISPLAY_ENCODER_5   4
#define DISPLAY_ENCODER_6   5

// LCD Contrast
#define LCD_CONTRAST_MIN 0
#define LCD_CONTRAST_DEFAULT 40
#define LCD_CONTRAST_MAX 64

// LED Brightness
#define LED_BRIGHTNESS_1 0x00
#define LED_BRIGHTNESS_2 0x40
#define LED_BRIGHTNESS_3 0x80
#define LED_BRIGHTNESS_4 0xC0

#define VOLUME_MIN         -100.0f // dB

#define CHANNEL_GAIN_MIN            -12.0f // dB
#define CHANNEL_GAIN_MAX             45.5f // dB
#define CHANNEL_PANORAMA_MIN       -100.0f // dB
#define CHANNEL_PANORAMA_MAX        100.0f // dB
#define CHANNEL_VOLUME_MIN         -100.0f // dB
#define CHANNEL_VOLUME_MAX           10.0f // dB

#define GATE_THRESHOLD_MIN            -80.0f // dB
#define GATE_THRESHOLD_MAX              0.0f // dB
#define GATE_RANGE_MIN                  3.0f // dB
#define GATE_RANGE_MAX                 60.0f // dB
#define GATE_ATTACK_MIN                 0.0f // ms
#define GATE_ATTACK_MAX               120.0f // ms
#define GATE_HOLD_MIN                   0.02f // ms
#define GATE_HOLD_MAX                2000.0f // ms
#define GATE_RELEASE_MIN                5.0f // ms
#define GATE_RELEASE_MAX             4000.0f // ms

#define DYNAMICS_THRESHOLD_MIN            -60.0f // dB
#define DYNAMICS_THRESHOLD_MAX              0.0f // dB
#define DYNAMICS_RATIO_MIN             1.1f //
#define DYNAMICS_RATIO_MAX           100.0f //
#define DYNAMICS_MAKEUP_MIN            0.0f // dB
#define DYNAMICS_MAKEUP_MAX           24.0f // dB
#define DYNAMICS_ATTACK_MIN            0.0f // ms
#define DYNAMICS_ATTACK_MAX          120.0f // ms
#define DYNAMICS_HOLD_MIN              0.2f // ms
#define DYNAMICS_HOLD_MAX           2000.0f // ms
#define DYNAMICS_RELEASE_MIN          5.0f // ms
#define DYNAMICS_RELEASE_MAX        4000.0f // ms

#define MAX_FX_SLOTS                    8

#define FX_REVERB_ROOMSIZE_MIN         0.0f // ms
#define FX_REVERB_ROOMSIZE_DEFAULT   150.0f // ms
#define FX_REVERB_ROOMSIZE_MAX      1000.0f // ms
#define FX_REVERB_RT60_MIN             0.0f // s
#define FX_REVERB_RT60_DEFAULT         3.0f // s
#define FX_REVERB_RT60_MAX           100.0f // s
#define FX_REVERB_LPFREQ_MIN          20.0f // Hz
#define FX_REVERB_LPFREQ_DEFAULT   14000.0f // Hz
#define FX_REVERB_LPFREQ_MAX       20000.0f // Hz
#define FX_REVERB_DRY_MIN              0.0f //
#define FX_REVERB_DRY_DEFAULT          1.0f //
#define FX_REVERB_DRY_MAX              1.0f //

#define FX_CHORUS_DEPTH_A_MIN          0.0f //
#define FX_CHORUS_DEPTH_A_DEFAULT     10.0f //
#define FX_CHORUS_DEPTH_A_MAX        100.0f //
#define FX_CHORUS_DEPTH_B_MIN          0.0f //
#define FX_CHORUS_DEPTH_B_DEFAULT     10.0f //
#define FX_CHORUS_DEPTH_B_MAX        100.0f //


#define MAX_CHAN_EQS                       4

#define NUM_INPUT_CHANNEL                  160 // just use a single AES50-port for now
#define NUM_OUTPUT_CHANNEL                 NUM_INPUT_CHANNEL
#define MAX_FPGA_TO_DSP1_CHANNELS          40
#define MAX_DSP1_TO_FPGA_CHANNELS          40
#define MAX_DSP1_TO_DSP2_CHANNELS          24
#define MAX_DSP2_TO_DSP1_CHANNELS          24
#define DSP_MAX_INTERNAL_CHANNELS          93
#define DSP_SAMPLES_IN_BUFFER              16

#define FPGA_INPUT_IDX_OFF				0
#define FPGA_INPUT_IDX_XLR				1
#define FPGA_INPUT_IDX_CARD				33
#define FPGA_INPUT_IDX_AUX				65
#define FPGA_INPUT_IDX_TALKBACK_INT		71
#define FPGA_INPUT_IDX_TALKBACK_EXT		72
#define FPGA_INPUT_IDX_DSP_RETURN		73
#define FPGA_INPUT_IDX_AES50A			113
#define FPGA_INPUT_IDX_AES50B			161

#define FPGA_OUTPUT_IDX_OFF				0
#define FPGA_OUTPUT_IDX_XLR				1
#define FPGA_OUTPUT_IDX_ULTRANET		17
#define FPGA_OUTPUT_IDX_CARD			33
#define FPGA_OUTPUT_IDX_AUX				65
#define FPGA_OUTPUT_IDX_DSP     		73
#define FPGA_OUTPUT_IDX_AES50A			113
#define FPGA_OUTPUT_IDX_AES50B			161

#define DSP_BUF_IDX_OFF			0	// no audio
#define DSP_BUF_IDX_DSPCHANNEL	1	// DSP-Channel 1-32
#define DSP_BUF_IDX_AUX			33	// Aux-Channel 1-8
#define DSP_BUF_IDX_DSP2_FX		41  // FXDSP2 FX-Channel 1-16
#define DSP_BUF_IDX_MIXBUS		57	// Mixbus 1-16
#define DSP_BUF_IDX_MAINLEFT	73	// main left
#define DSP_BUF_IDX_MAINRIGHT	74	// main right
#define DSP_BUF_IDX_MAINSUB		75	// main sub
#define DSP_BUF_IDX_MATRIX		76	// Matrix 1-6
#define DSP_BUF_IDX_DSP2_AUX	82	// FXDSP2 AUX-Channel 1-8
#define DSP_BUF_IDX_MONLEFT		90	// Monitor Left
#define DSP_BUF_IDX_MONRIGHT	91	// Monitor Right
#define DSP_BUF_IDX_TALKBACK	92	// Talkback

#define SURFACE_COLOR_BLACK 0
#define SURFACE_COLOR_RED 1
#define SURFACE_COLOR_GREEN 2
#define SURFACE_COLOR_YELLOW 3
#define SURFACE_COLOR_BLUE 4
#define SURFACE_COLOR_PINK 5
#define SURFACE_COLOR_CYAN 6
#define SURFACE_COLOR_WHITE 7
#define SURFACE_COLOR_INVERTED 8

// channelparameter (in / out) - probed on "X-USB:A:3" card
#define CARD_CHANNELMODE_32IN_32OUT     0
#define CARD_CHANNELMODE_16IN_16OUT     1
#define CARD_CHANNELMODE_32IN_8OUT      2
#define CARD_CHANNELMODE_8IN_32OUT      3
#define CARD_CHANNELMODE_8IN_8OUT       4
#define CARD_CHANNELMODE_2IN_2OUT       5

#define MAX_FADERS 25   // counted on X32 Full

// Maximal mögliche Paketlänge inklusive Startbyte, Endbyte und Checksumme
// Langes Paket: 0xFE (1) + BoardID (1) + ID (1) + Value_MSB (1) + Value_LSB (1) + 0xFE (1) + CHECKSUM (1) = 7 Bytes
#define MAX_MESSAGE_SIZE 200

#define MAX_VCHANNELS \
    (uint)X32_VCHANNEL_BLOCK_SIZE::NORMAL + \
    (uint)X32_VCHANNEL_BLOCK_SIZE::AUX + \
    (uint)X32_VCHANNEL_BLOCK_SIZE::FXRET + \
    (uint)X32_VCHANNEL_BLOCK_SIZE::BUS + \
    (uint)X32_VCHANNEL_BLOCK_SIZE::MATRIX + \
    (uint)X32_VCHANNEL_BLOCK_SIZE::DCA + \
    (uint)X32_VCHANNEL_BLOCK_SIZE::MAIN + \
    (uint)X32_VCHANNEL_BLOCK_SIZE::MAINSUB + \
    (uint)X32_VCHANNEL_BLOCK_SIZE::SPECIAL

#define VCHANNEL_NOT_SET MAX_VCHANNELS+1

// (uint32_t)(pow(2, 31) * pow(10, _DBFS / 20.0))
#define VUTRESH_10_DBFS 6790939565
#define VUTRESH_09_DBFS 6052431258
#define VUTRESH_08_DBFS 5394235037
#define VUTRESH_07_DBFS 4807617037
#define VUTRESH_06_DBFS 4284793194
#define VUTRESH_05_DBFS 3818825954
#define VUTRESH_04_DBFS 3403532214
#define VUTRESH_03_DBFS 3033401279
#define VUTRESH_02_DBFS 2703521735
#define VUTRESH_01_DBFS 2409516283
#define VUTRESH_00_DBFS 2147483648
#define VUTRESH_00_DBFS_CLIP 2120000000  // should be 2147483648, but turn-on CLIP-led on before real clipping
#define VUTRESH_MINUS_01_DBFS 1913946815
#define VUTRESH_MINUS_02_DBFS 1705806895
#define VUTRESH_MINUS_03_DBFS 1520301995
#define VUTRESH_MINUS_04_DBFS 1354970579
#define VUTRESH_MINUS_05_DBFS 1207618800
#define VUTRESH_MINUS_06_DBFS 1076291388
#define VUTRESH_MINUS_07_DBFS 959245709
#define VUTRESH_MINUS_08_DBFS 854928638
#define VUTRESH_MINUS_09_DBFS 761955951
#define VUTRESH_MINUS_10_DBFS 679093956
#define VUTRESH_MINUS_11_DBFS 605243125
#define VUTRESH_MINUS_12_DBFS 539423503
#define VUTRESH_MINUS_13_DBFS 480761703
#define VUTRESH_MINUS_14_DBFS 428479319
#define VUTRESH_MINUS_15_DBFS 381882595
#define VUTRESH_MINUS_16_DBFS 340353221
#define VUTRESH_MINUS_17_DBFS 303340127
#define VUTRESH_MINUS_18_DBFS 270352173
#define VUTRESH_MINUS_19_DBFS 240951628
#define VUTRESH_MINUS_20_DBFS 214748364
#define VUTRESH_MINUS_21_DBFS 191394681
#define VUTRESH_MINUS_22_DBFS 170580689
#define VUTRESH_MINUS_23_DBFS 152030199
#define VUTRESH_MINUS_24_DBFS 135497057
#define VUTRESH_MINUS_25_DBFS 120761880
#define VUTRESH_MINUS_26_DBFS 107629138
#define VUTRESH_MINUS_27_DBFS 95924570
#define VUTRESH_MINUS_28_DBFS 85492863
#define VUTRESH_MINUS_29_DBFS 76195595
#define VUTRESH_MINUS_30_DBFS 67909395
#define VUTRESH_MINUS_31_DBFS 60524312
#define VUTRESH_MINUS_32_DBFS 53942350
#define VUTRESH_MINUS_33_DBFS 48076170
#define VUTRESH_MINUS_34_DBFS 42847931
#define VUTRESH_MINUS_35_DBFS 38188259
#define VUTRESH_MINUS_36_DBFS 34035322
#define VUTRESH_MINUS_37_DBFS 30334012
#define VUTRESH_MINUS_38_DBFS 27035217
#define VUTRESH_MINUS_39_DBFS 24095162
#define VUTRESH_MINUS_40_DBFS 21474836
#define VUTRESH_MINUS_41_DBFS 19139468
#define VUTRESH_MINUS_42_DBFS 17058068
#define VUTRESH_MINUS_43_DBFS 15203019
#define VUTRESH_MINUS_44_DBFS 13549705
#define VUTRESH_MINUS_45_DBFS 12076188
#define VUTRESH_MINUS_46_DBFS 10762913
#define VUTRESH_MINUS_47_DBFS 9592457
#define VUTRESH_MINUS_48_DBFS 8549286
#define VUTRESH_MINUS_49_DBFS 7619559
#define VUTRESH_MINUS_50_DBFS 6790939
#define VUTRESH_MINUS_51_DBFS 6052431
#define VUTRESH_MINUS_52_DBFS 5394235
#define VUTRESH_MINUS_53_DBFS 4807617
#define VUTRESH_MINUS_54_DBFS 4284793
#define VUTRESH_MINUS_55_DBFS 3818825
#define VUTRESH_MINUS_56_DBFS 3403532
#define VUTRESH_MINUS_57_DBFS 3033401
#define VUTRESH_MINUS_58_DBFS 2703521
#define VUTRESH_MINUS_59_DBFS 2409516
#define VUTRESH_MINUS_60_DBFS 2147483
